when:
  - event: ["push"]
    branch: ["main"]

engine: "nixery"

clone:
  skip: false
  depth: 1
  submodules: false

dependencies:
  nixpkgs:
    - gnused
    - nodejs_24
    - pnpm

environment:
  NODE_ENV: "production"
  PUBLIC_BASE_URL: "https://skywrapped.app"
  PORT: ""
  LOG_LEVEL: "info"

steps:
  - name: "Install dependencies"
    command: "pnpm install --frozen-lockfile"
  - name: "Run QA"
    command: "pnpm run qa"
  - name: "Build"
    command: "pnpm run build"
